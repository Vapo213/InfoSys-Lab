DROP VIEW V1_PROF_DWS;
CREATE VIEW V1_PROF_DWS (ID, NAME, MINDWS, SEM, FACH_AMT, DWS)
AS 
(SELECT DISTINCT D.DOZENT_ID, D.NACHNAME, P.MINIMUN_DWS, Z.ZEITSEMESTER_BEZEICHNUNG, A.AMT_BEZEICHNUNG, A.AMT_DWS
   FROM AMT AS A, DOZENT AS D, PROFESSOR AS P, ZEITSEMESTER AS Z
   WHERE D.DOZENT_ID = P.DOZENT_ID AND P.DOZENT_ID = A.DOZENT_ID AND Z.ZEITSEMESTER_ID = A.ZEITSEMESTER_ID
UNION ALL
SELECT DISTINCT D.DOZENT_ID, D.NACHNAME, P.MINIMUN_DWS, S.ZEITSEMESTER_BEZEICHNUNG, V.VERANSTALTUNG_BEZEICHNUNG, V.DWS
   FROM DOZENT AS D, PROFESSOR AS P, VERANSTALTUNG AS V, ZUORDNUNG_VERANSTALTUNG_DOZENT AS Z, ZEITSEMESTER AS S
   WHERE D.DOZENT_ID = P.DOZENT_ID AND D.DOZENT_ID = Z.DOZENT_ID AND V.VERANSTALTUNG_ID = Z.VERANSTALTUNG_ID AND S.ZEITSEMESTER_ID = Z.ZEITSEMESTER_ID
)
;

DROP VIEW V2_VERANSTALTUNGEN;
CREATE VIEW V2_VERANSTALTUNGEN (SEM, STUDGANG, MODUL) AS
SELECT DISTINCT ZS.ZEITSEMESTER_BEZEICHNUNG, S.STUDIENGANG_BEZEICHNUNG, M.MODUL_BEZEICHNUNG
   FROM ZEITSEMESTER AS ZS, STUDIENGANG AS S, MODUL AS M, ZUORDNUNG_VERANSTALTUNG_DOZENT AS Z
, VERANSTALTUNG AS V, DOZENT AS D, FAKULTAET AS F
   WHERE Z.ZEITSEMESTER_ID = Z.ZEITSEMESTER_ID 
AND V.VERANSTALTUNG_ID = Z.VERANSTALTUNG_ID 
AND D.DOZENT_ID = Z.DOZENT_ID 
AND F.FAKULTAET_ID = D.FAKULTAET_ID 
AND F.FAKULTAET_ID = S.FAKULTAET_ID
;

DROP VIEW V3_LB;
CREATE VIEW V3_LB (NAME, STRASSE, NR, PLZ, ORT, DWS, SEM) AS
SELECT DISTINCT D.NACHNAME, LB.STRASSE, LB.HAUSNUMMER
, LB.PLZ, LB.WOHNORT, V.DWS, ZS.ZEITSEMESTER_BEZEICHNUNG
FROM DOZENT AS D, LEHRBEAUFTRAGTER AS LB, VERANSTALTUNG AS V
, ZEITSEMESTER AS ZS, ZUORDNUNG_VERANSTALTUNG_DOZENT AS Z
WHERE D.DOZENT_ID = LB.DOZENT_ID AND D.DOZENT_ID = Z.DOZENT_ID 
AND ZS.ZEITSEMESTER_ID = Z.ZEITSEMESTER_ID AND V.VERANSTALTUNG_ID = Z.VERANSTALTUNG_ID;

DROP VIEW V4_DIFFAK;
CREATE VIEW V4_DIFFAK (FAK, SEM, MODUL, DWS, NAME, DOZ_FAK) AS

SELECT DISTINCT F.FAKULTAET_BEZEICHNUNG, Z.ZEITSEMESTER_ID
, M.MODUL_BEZEICHNUNG, Z.VERANSTALTUNG_DWS, D.NACHNAME, FAK


FROM FAKULTAET AS F, DOZENT AS D, MODUL AS M, STUDIENGANG AS S
, STUPO AS ST, STUPO_MODUL AS SM, VERANSTALTUNG AS V
, ZUORDNUNG_VERANSTALTUNG_DOZENT AS Z
, ( SELECT  FA.FAKULTAET_ID, FA.FAKULTAET_BEZEICHNUNG AS FAK
   FROM DOZENT AS DO, FAKULTAET AS FA
   WHERE FA.FAKULTAET_ID = DO.FAKULTAET_ID ) AS FA

WHERE D.DOZENT_ID = Z.DOZENT_ID AND S.STUDIENGANG_ID = ST.STUDIENGANG_ID 
AND ST.STUPO_ID = SM.STUPO_ID AND M.MODUL_ID = SM.MODUL_ID AND M.MODUL_ID = V.MODUL_ID 
AND D.FAKULTAET_ID <> S.FAKULTAET_ID AND F.Fakultaet_ID = S.Fakultaet_ID AND FA.FAKULTAET_ID = D.FAKULTAET_ID
;


DROP VIEW NZV_WS17;
CREATE VIEW NZV_WS17 (V_ID, BEZEICHNUNG, Z_ID, SEMESTER) AS
SELECT DISTINCT V.VERANSTALTUNG_ID, VERANSTALTUNG_BEZEICHNUNG, Z.ZEITSEMESTER_ID, ZEITSEMESTER_BEZEICHNUNG
   FROM VERANSTALTUNG AS V, ZUORDNUNG_VERANSTALTUNG_DOZENT AS Z, ZEITSEMESTER AS S
WHERE Z.ZEITSEMESTER_ID = S.ZEITSEMESTER_ID
AND Z.ZEITSEMESTER_ID = '16'
AND V.VERANSTALTUNG_ID NOT IN Z.VERANSTALTUNG_ID;